{% extends "base.html" %}
{% block content %}

<h2>Statistics (Teacher)</h2>

<!--
stats:
{
  "per_class": {
    "7-a": [
      { "section_number": 1, "ds":..., "ys":... },
      { "section_number": 2, "ds":..., "ys":... }
    ],
    "7-b": [...],
    ...
  },
  "school_summary": [
    {
      "section_number": 1,
      "ds_total": 35,
      "ys_total": 18,
      "sn_success": 50,
      "classes": {
        "7-a": 65,
        "7-b": 45,
        "7-c": 55
      }
    },
    ...
  ]
}
-->

<!-- PART 1: Table for Each Class -->
{% for cls_name, row_list in stats.per_class.items() %}
<div style="margin-bottom: 30px;">
    <p><strong>Class: {{ cls_name }}</strong></p>
    <table class="table">
        <thead>
            <tr>
                <th>Questions</th>
                <th>Correct (DS)</th>
                <th>Incorrect (YS)</th>
            </tr>
        </thead>
        <tbody>
            {% for secrow in row_list %}
            <tr>
                <td>{{ secrow.section_number }}s.</td>
                <td>{{ secrow.ds }}</td>
                <td>{{ secrow.ys }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endfor %}

<!-- PART 2: School Summary Table -->
<div>
    <p><strong>School Summary</strong> (School ID: 1)</p>
    <!-- Questions   ds  ys   section success   7a   7b  7c   avg ??? -->
    <table class="table">
        <thead>
            <tr>
                <th>Questions</th>
                <th>Correct (DS)</th>
                <th>Incorrect (YS)</th>
                <th>Section Success</th>
                <!-- dynamic columns for each class_name -->
                {% if stats.per_class %}
                {% for cls_name in stats.per_class.keys() %}
                <th>{{ cls_name }}</th>
                {% endfor %}
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for row in stats.school_summary %}
            <tr>
                <td>{{ row.section_number }}s.</td>
                <td>{{ row.ds_total }}</td>
                <td>{{ row.ys_total }}</td>
                <td>{{ row.sn_success }} %</td>
                {% if stats.per_class %}
                {% for cls_name in stats.per_class.keys() %}
                <td>
                    {% if cls_name in row.classes %}
                    {{ row.classes[cls_name] }}%
                    {% else %}
                    0%
                    {% endif %}
                </td>
                {% endfor %}
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}