<!-- templates/teacher_view_stats.html -->
{% extends "base.html" %}
{% block content %}
<h2>İstatistikler (Teacher)</h2>

{% set stats = stats or {} %}
{% if not stats.per_class and not stats.school_summary %}
<p>Hiç istatistik bulunamadı.</p>
{% else %}

/* Her Sınıf için tablo */
{% for cls_name, row_list in stats.per_class.items() %}
<div style="margin-bottom: 30px;">
    <p><strong>Sınıf: {{ cls_name }}</strong></p>
    <table class="table">
        <thead>
            <tr>
                <th>Section</th>
                <th>Correct Answers</th>
                <th>Wrong Answers</th>
            </tr>
        </thead>
        <tbody>
            {% for secrow in row_list %}
            <tr>
                <td>{{ secrow.section_number }}</td>
                <td>{{ secrow.correct_answers }}</td>
                <td>{{ secrow.wrong_answers }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endfor %}

/* Okul Özeti */
<div>
    <p><strong>Okul Özeti</strong></p>
    <table class="table">
        <thead>
            <tr>
                <th>Section</th>
                <th>Correct Total</th>
                <th>Wrong Total</th>
                <th>Başarı (%)</th>
                {% if stats.per_class %}
                {% for cls_name in stats.per_class.keys() %}
                <th>{{ cls_name }}</th>
                {% endfor %}
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for row in stats.school_summary %}
            <tr>
                <td>{{ row.section_number }}</td>
                <td>{{ row.correct_answers_total }}</td>
                <td>{{ row.wrong_answers_total }}</td>
                <td>{{ row.sn_basarisi }}%</td>
                {% if stats.per_class %}
                {% for cls_name in stats.per_class.keys() %}
                <td>
                    {% if cls_name in row.classes %}
                    {{ row.classes[cls_name] }}%
                    {% else %}
                    0%
                    {% endif %}
                </td>
                {% endfor %}
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}
{% endblock %}